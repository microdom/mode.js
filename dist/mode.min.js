/* MIT License Copyright (c) 2025 Silvio Corigliano https://github.com/microdom/mode.js */
function µ(a,b){function c(a){a.forEach(a=>a.setAttribute(`µicro`,"\xB5")),K=d(`/[µicro]/`),K.forEach(a=>a.removeAttribute(`µicro`))}function d(a){a=i(a)?G(a):a;const b=(a,b)=>"/"==a.at(0)&&"/"==a.at(-1)?b.querySelectorAll(a.replace(/^\/|\/$/g,"")):b.querySelector(a);if(g(a)||h(a))return a;if(f(a)){let d,e;return i(a[1])?e=document.querySelector(a[1]):g(a[1])&&(e=a[1]),i(a[0])?(d=a[0],b(d,e)):g(a[0])?a:console.error("Array error")}return j(a)?m(a):i(a)?b(a,document):void 0}function f(a){return Array.isArray(a)}function g(a){return a instanceof HTMLElement}function h(a){return NodeList.prototype.isPrototypeOf(a)}function i(a){return"string"==typeof a||a instanceof String}function j(a){return"<"===a[0]&&">"===a[a.length-1]}function k(a){return!!i(a)&&void(h(K)||f(K)?K.forEach(b=>b.innerHTML=a):K.innerHTML=a)}function l(a){return!!i(a)&&void(h(K)||f(K)?K.forEach(b=>b.textContent=a):K.textContent=a)}function m(a){let b=J("div",{},"","");return b.insertAdjacentHTML("beforeend",a.replace(/\s+/g," ")),b.firstChild}function n(a){j(a)?K.insertAdjacentHTML("beforeend",a.replace(/\s+/g," ")):g(a)&&K.appendChild(a)}function o(a){const b=(a,b,c=null)=>{c=!c?K:c,console.log(c,"\xB7\xB7\xB7\xB7"),h(c)||f(c)?c.forEach(c=>c.addEventListener(a,b,!1)):c.addEventListener(a,b,!1)},c=a=>{a.e&&(f(a.e)?a.e.forEach(c=>b(c,a.fn)):b(a.e,a.fn)),a.l&&(f(a.l)?a.l.forEach(c=>b(a.e,c.fn,c.tg)):b(a.e,a.l.fn,a.l.tg))};f(a)?a.forEach(a=>c(a)):c(a)}function e(a){h(K)||f(K)?K.forEach(a):a(K)}function p(a){K=a(K)}function q(a){const b=(a,b)=>"/"==a.at(0)&&"/"==a.at(-1)?b.querySelectorAll(a.replace(/^\/|\/$/g,"")):b.querySelector(a);let c,e=document.createElement("div");h(K)||f(K)?K.forEach(d=>{c=b(a,d),null!=c&&e.append(c)}):K=d([a,K]),0<e.childNodes.length&&(K=e.childNodes)}function r(a){if(h(K))return!1;if(a){let b=K.previousElementSibling;for(;b&&!b.matches(a);)b=b.previousElementSibling;K=b}else K=K.previousElementSibling}function s(a){if(h(K))return!1;if(a){let b=K.nextElementSibling;for(;b&&!b.matches(a);)b=b.nextElementSibling;K=b}else K=K.nextElementSibling}function t(b){if(!g(K))return!1;const c=[];for(a=K;(a=a.parentNode)&&a!==document;)!b||a.matches(b)?c.push(a):D;K=c}function u(a){if(!g(K))return!1;let b=[];for(const c of K.childNodes)g(c)&&(!a||c.matches(a))?b.push(c):D;c(b)}function v(a){return!!g(K)&&void K.parentNode.insertBefore(a,K.nextSibling)}function w(b){return!!g(K)&&void(a=[...K.children].filter(a=>b?a.matches(b):a),c(a))}function x(a){if(!h(K)&&!f(K))return null;let b;i(a)?K.forEach(c=>c.matches(a)?b=c:D):K.forEach(a=>b=a),K=b}function y(a){if(!h(K)&&!f(K))return null;if(i(a))try{K.forEach(b=>{if(b.matches(a))throw K=b,"break"})}catch(a){if("break"!==a)throw a}else try{K.forEach((a,b)=>{if(0===b)throw K=a,"break"})}catch(a){if("break"!==a)throw a}}function z(b){return!!g(K)&&void(a=[...K.parentNode.children].filter(a=>b?a.matches(b):a),c(a))}function A(b){return!!g(K)&&void(a=[...K.parentNode.children].filter(a=>b?a.matches(b)&&a!==K:a!==K),c(a))}function B(b){return!!(h(K)&&b)&&void(a=[...K].filter(a=>a.matches(b)),c(a))}function C(a){const b=(a,b)=>{a.parentElement.insertBefore(b,a),b.appendChild(a)};h(K)||f(K)?K.forEach(c=>b(c,a.cloneNode())):b(K,a.cloneNode())}const D=null,E="[\\x20\\t\\r\\n\\f]",F=new RegExp("^"+E+"+|((?:^|[^\\\\])(?:\\\\.)*)"+E+"+$","g"),G=a=>a.replace(/^\s\s*/,"").replace(/\s\s*$/,"").replace(/(\r\n|\n|\r)/gm,"").replace(/>\s+</g,"><"),H=(a,b=null)=>b?"array"==b?Array.from(a):Object[b](a):Object.entries(a),I={html:k,text:l,insert:n,on:o,each:e,proceed:p,find:q,css:function(a){const b=(a,b)=>{h(K)||f(K)?K.forEach(c=>c.style[a]=b):K.style[a]=b};Object.keys(a).map(c=>b(c,a[c]))},classes:function(a){const b=(a,b)=>{const c=(a,b,c)=>{f(c)?c.forEach(c=>a.classList[b](c)):a.classList[b](c)};h(K)||f(K)?K.forEach(d=>c(d,a,b)):c(K,a,b)};Object.keys(a).map(c=>b(c,a[c]))},clss:function(a){const b=(a,b)=>{const c=(a,b,c)=>{f(c)?c.forEach(c=>a.classList[b](c)):a.classList[b](c)};h(K)||f(K)?K.forEach(d=>c(d,a,b)):c(K,a,b)};Object.keys(a).map(c=>b(c,a[c]))},attr:function(a){const b=(a,b,c)=>{"set"===b?a.setAttribute(H(c)[0][0],H(c)[0][1]):"get"===b?a.getAttribute(c):"del"===b?a.removeAttribute(c):"has"===b?a.hasAttribute(c):"tog"===b?a.toggleAttribute(c):"list"===b?a.getAttributeNames():void 0},c=(a,c)=>{const d=(a,c,d)=>{f(d)?d.forEach(d=>b(a,c,d)):b(a,c,d)};h(K)||f(K)?K.forEach(b=>d(b,a,c)):d(K,a,c)};Object.keys(a).map(b=>c(b,a[b]))},prev:r,next:s,parents:t,childs:u,after:v,children:w,last:x,first:y,siblingsAll:z,siblings:A,filter:B,wrap:C},J=(a,b,c)=>{function d(a){return"object"==typeof a?Object.keys(a).map(b=>`${b}:${a[b]}`).join(";"):a}let e=document.createElement(a);for(const f in b)e.setAttribute(f,d(b[f]));if(c){let a=document.createTextNode(c);e.appendChild(a)}for(const d in u)e.appendChild(u[d]);return e};let K=a===D?a:d(a);if(!!b)for(let[a,c]of Object.entries(b))a=a.replace(/_/g,""),K&&"function"==typeof I[a]?I[a](c):null;return f(K)&&0===K.length?D:K}function moveDOM(fns){function isArr(a){return Array.isArray(a)}function isEl(a){return a instanceof HTMLElement}function isList(a){return NodeList.prototype.isPrototypeOf(a)}function isStr(a){return"string"==typeof a||a instanceof String}function wrap(a){const b=(a,b)=>{a.parentElement.insertBefore(b,a),b.appendChild(a)};isList(a.el)?a.el.forEach(c=>b(c,a.wrp.cloneNode())):b(a.el,a.wrp.cloneNode())}function slideUp(a){let b={transitionProperty:"height, margin, padding",transitionDuration:a.t+"ms",boxSizing:"border-box",height:a.el.offsetHeight+"px"};µ(a.el,{css:b}),a.el.offsetHeight,µ(a.el,{css:{overflow:"hidden",height:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0}}),setTimeout(()=>{["height","padding-top","padding-bottom","margin-top","margin-bottom","overflow","transition-duration","transition-property"].forEach(b=>a.el.style.removeProperty(b)),a.el.style.display="none",a.fn?a.fn():_},a.t)}function slideDown(a){let b=getComputedStyle(a.el).display;"none"===b&&(b="block"),a.el.style.display=b;let c=a.el.offsetHeight;const d=Math.ceil(a.t*(c/200));console.log("time >>",d);µ(a.el,{css:{overflow:"hidden",height:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0}}),a.el.offsetHeight,µ(a.el,{css:{boxSizing:"border-box",transitionProperty:"height, margin, padding",transitionDuration:d+"ms",height:c+"px"}});["padding-top","padding-bottom","margin-top","margin-bottom"].forEach(b=>a.el.style.removeProperty(b));setTimeout(()=>{["height","overflow","transition-duration","transition-property"].forEach(b=>a.el.style.removeProperty(b)),a.fn?a.fn():_},d)}function slideToggle(a){"none"===getComputedStyle(a.el).display?slideDown(a):slideUp(a)}function offset(a){let b=a.getBoundingClientRect(),c=document.body;_return={top:b.top+c.scrollTop,left:b.left+c.scrollLeft}}function pos(a){let b=a.getBoundingClientRect(),c=document.body;_return={top:b.top+c.scrollTop,left:b.left+c.scrollLeft}}function last(a){_return=a.length?a[a.length-1]:_}function first(a){_return=a.length?a[0]:_}const _=null;let _return;if(fns)for(let[fn,params]of Object.entries(fns))fn=fn.replace(/_/g,""),"function"==typeof eval(fn)?eval(fn)(params):null;return _return?_return:void 0}µ.e=(a,c=null,d=!0)=>d?new CustomEvent(a,{detail:c,bubbles:d}):new Event(a),µ.l=(a,b,c)=>a.addEventListener(b,c),µ.d=(a,b=null)=>b?b.dispatchEvent(a):null,µ.t=(a,b=null)=>(a.preventDefault(),a.stopPropagation(),b)?µ(a.target.closest(b)):a.target,µ.a=(a,b=null)=>b?"array"==b?Array.from(a):Object[b](a):Object.entries(a),µ.ar=µ.a,µ.ax=a=>new Promise((b,c)=>{const d=new XMLHttpRequest,e=a.method?a.method.toUpperCase():"GET";let f=a.url||"";const g="GET"===e,h=a.headers||{};if(g&&a.data){const b=new URLSearchParams(a.data).toString();f+=(f.includes("?")?"&":"?")+b}for(let a in d.open(e,f,!0),h)d.setRequestHeader(a,h[a]);h["Content-Type"]||a.data instanceof FormData||"GET"===e||d.setRequestHeader("Content-Type","application/json"),a.timeout&&(d.timeout=a.timeout),d.onload=()=>{const a=200<=d.status&&300>d.status;let e=d.responseText;try{e=JSON.parse(e)}catch(a){}a?b({response:e,status:d.status,xhr:d}):c({error:d.statusText,status:d.status,xhr:d})},d.onerror=()=>{c({error:d.statusText,status:d.status,xhr:d})};let i=null;!g&&a.data&&(a.data instanceof FormData?i=a.data:i=JSON.stringify(a.data)),d.send(i)}),"undefined"!=typeof window&&(window._=null,window.html=String.raw,window.µ=µ,window._µ=moveDOM);